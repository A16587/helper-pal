<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Â· Ù†ÙÙ…Ø§Ø¡</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Cairo', sans-serif;
}
body {
background: #f0f5fa;
min-height: 100vh;
padding: 0;
overflow-x: hidden;
}
/* Ø´Ø§Ø´Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† */
.admin-login-container {
background: white;
width: 90%;
max-width: 400px;
margin: 60px auto;
padding: 50px 40px;
border-radius: 30px;
box-shadow: 0 20px 40px rgba(0, 59, 94, 0.08);
text-align: center;
border: 1px solid rgba(15, 59, 94, 0.05);
}
.admin-login-container h1 {
color: #1a4b6d;
font-size: 2.2rem;
margin-bottom: 10px;
font-weight: 700;
}
.admin-login-container p {
color: #6b8ca8;
margin-bottom: 35px;
font-size: 1rem;
}
.admin-login-container input {
width: 100%;
padding: 16px 20px;
margin-bottom: 16px;
border: 1px solid #e2eaf1;
border-radius: 50px;
font-size: 1.05rem;
background: #f9fcff;
}
.admin-login-container input:focus {
outline: none;
border-color: #1a4b6d;
background: white;
box-shadow: 0 0 0 3px rgba(26, 75, 109, 0.1);
}
.admin-login-container button {
width: 100%;
padding: 16px;
background: linear-gradient(145deg, #1a4b6d, #0f3b5e);
color: white;
border: none;
border-radius: 50px;
font-size: 1.15rem;
font-weight: 600;
cursor: pointer;
transition: 0.3s;
}
.admin-login-container button:hover {
transform: scale(1.02);
box-shadow: 0 8px 25px rgba(26, 75, 109, 0.3);
}
/* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
.admin-dashboard {
display: none;
padding: 20px;
max-width: 1400px;
margin: 0 auto;
}
.admin-header {
background: linear-gradient(145deg, #1a4b6d, #0f3b5e);
color: white;
padding: 25px 30px;
border-radius: 25px;
margin-bottom: 25px;
display: flex;
justify-content: space-between;
align-items: center;
box-shadow: 0 10px 30px rgba(26, 75, 109, 0.2);
}
.admin-header h1 {
font-size: 1.8rem;
font-weight: 700;
}
.admin-header .logout-btn {
background: rgba(255,255,255,0.2);
color: white;
border: none;
padding: 12px 25px;
border-radius: 50px;
cursor: pointer;
font-weight: 600;
transition: 0.3s;
}
.admin-header .logout-btn:hover {
background: rgba(255,255,255,0.3);
}
/* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px;
margin-bottom: 30px;
}
.stat-card {
background: white;
padding: 25px;
border-radius: 20px;
box-shadow: 0 8px 25px rgba(0, 59, 94, 0.05);
border: 1px solid #eef2f8;
transition: 0.3s;
}
.stat-card:hover {
transform: translateY(-5px);
box-shadow: 0 15px 35px rgba(0, 59, 94, 0.08);
}
.stat-card .stat-icon {
font-size: 2.5rem;
margin-bottom: 15px;
}
.stat-card .stat-number {
font-size: 2.5rem;
font-weight: 700;
color: #1a4b6d;
margin-bottom: 5px;
}
.stat-card .stat-label {
color: #6b8ca8;
font-size: 1rem;
}
/* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
.admin-section {
background: white;
border-radius: 25px;
padding: 25px;
margin-bottom: 25px;
box-shadow: 0 8px 25px rgba(0, 59, 94, 0.05);
border: 1px solid #eef2f8;
}
.section-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
padding-bottom: 15px;
border-bottom: 2px solid #f0f5fa;
flex-wrap: wrap;
gap: 10px;
}
.section-header h2 {
color: #1e3b5c;
font-size: 1.4rem;
display: flex;
align-items: center;
gap: 10px;
}
.section-header .btn-group {
display: flex;
gap: 10px;
flex-wrap: wrap;
}
.section-header .refresh-btn {
background: #e8f0f8;
color: #1a4b6d;
border: none;
padding: 10px 20px;
border-radius: 50px;
cursor: pointer;
font-weight: 600;
transition: 0.3s;
}
.section-header .refresh-btn:hover {
background: #d0e4ed;
}
.section-header .delete-all-btn {
background: linear-gradient(145deg, #dc2626, #b91c1c);
color: white;
border: none;
padding: 10px 20px;
border-radius: 50px;
cursor: pointer;
font-weight: 600;
transition: 0.3s;
display: flex;
align-items: center;
gap: 8px;
}
.section-header .delete-all-btn:hover {
background: linear-gradient(145deg, #b91c1c, #991b1b);
transform: scale(1.05);
}
/* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
.table-container {
overflow-x: auto;
border-radius: 15px;
border: 1px solid #eef2f8;
}
.admin-table {
width: 100%;
border-collapse: collapse;
}
.admin-table th {
background: linear-gradient(145deg, #1a4b6d, #0f3b5e);
color: white;
padding: 15px;
text-align: right;
font-weight: 600;
font-size: 0.95rem;
}
.admin-table td {
padding: 15px;
border-bottom: 1px solid #eef2f8;
color: #4a6782;
font-size: 0.95rem;
}
.admin-table tr:hover {
background: #f8fbfe;
}
.admin-table tr:last-child td {
border-bottom: none;
}
/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
.action-btn {
padding: 8px 15px;
border: none;
border-radius: 20px;
cursor: pointer;
font-size: 0.85rem;
font-weight: 600;
transition: 0.3s;
}
.delete-btn {
background: #fee2e2;
color: #dc2626;
}
.delete-btn:hover {
background: #fecaca;
}
.view-btn {
background: #e8f0f8;
color: #1a4b6d;
}
.view-btn:hover {
background: #d0e4ed;
}
/* Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
.loading {
text-align: center;
padding: 50px;
color: #6b8ca8;
font-size: 1.1rem;
}
.loading-spinner {
width: 50px;
height: 50px;
border: 4px solid #e2eaf1;
border-top-color: #1a4b6d;
border-radius: 50%;
animation: spin 1s linear infinite;
margin: 0 auto 20px;
}
@keyframes spin {
to { transform: rotate(360deg); }
}
/* Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª */
.no-data {
text-align: center;
padding: 50px;
color: #6b8ca8;
background: #f8fbfe;
border-radius: 15px;
border: 2px dashed #eef2f8;
}
/* Ø§Ù„Ø´Ø§Ø±Ø© */
.badge {
padding: 4px 12px;
border-radius: 20px;
font-size: 0.8rem;
font-weight: 600;
}
.badge-success {
background: #d1fae5;
color: #059669;
}
.badge-warning {
background: #fef3c7;
color: #d97706;
}
.badge-danger {
background: #fee2e2;
color: #dc2626;
}
/* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ */
@media (max-width: 768px) {
.admin-header {
flex-direction: column;
gap: 15px;
text-align: center;
}
.stats-grid {
grid-template-columns: 1fr;
}
.admin-table {
font-size: 0.85rem;
}
.admin-table th,
.admin-table td {
padding: 10px;
}
.section-header {
flex-direction: column;
gap: 15px;
text-align: center;
}
.section-header .btn-group {
width: 100%;
justify-content: center;
}
}
/* Ø³ÙƒØ±ÙˆÙ„ Ø¨Ø§Ø± */
.table-container::-webkit-scrollbar {
height: 8px;
}
.table-container::-webkit-scrollbar-track {
background: #f0f5fa;
border-radius: 10px;
}
.table-container::-webkit-scrollbar-thumb {
background: #c5d5e4;
border-radius: 10px;
}
.table-container::-webkit-scrollbar-thumb:hover {
background: #1a4b6d;
}
/* Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯ */
.confirm-modal {
display: none;
position: fixed;
inset: 0;
background: rgba(0, 0, 0, 0.5);
z-index: 5000;
align-items: center;
justify-content: center;
}
.confirm-modal.show {
display: flex;
}
.confirm-modal-content {
background: white;
padding: 40px;
border-radius: 25px;
max-width: 450px;
width: 90%;
text-align: center;
}
.confirm-modal-icon {
font-size: 4rem;
margin-bottom: 20px;
}
.confirm-modal h3 {
color: #1e3b5c;
font-size: 1.5rem;
margin-bottom: 15px;
}
.confirm-modal p {
color: #6b8ca8;
margin-bottom: 25px;
line-height: 1.6;
}
.confirm-modal-buttons {
display: flex;
gap: 15px;
justify-content: center;
}
.confirm-cancel-btn {
background: #e8f0f8;
color: #1a4b6d;
border: none;
padding: 12px 30px;
border-radius: 50px;
cursor: pointer;
font-weight: 600;
transition: 0.3s;
}
.confirm-cancel-btn:hover {
background: #d0e4ed;
}
.confirm-delete-btn {
background: linear-gradient(145deg, #dc2626, #b91c1c);
color: white;
border: none;
padding: 12px 30px;
border-radius: 50px;
cursor: pointer;
font-weight: 600;
transition: 0.3s;
}
.confirm-delete-btn:hover {
background: linear-gradient(145deg, #b91c1c, #991b1b);
}
</style>
</head>
<body>
<!-- Ø´Ø§Ø´Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† -->
<div class="admin-login-container" id="adminLoginView">
<h1>ğŸ” Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
<p>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†ØµØ© Ù†ÙÙ…Ø§Ø¡</p>
<input type="text" id="adminUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input type="password" id="adminPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="adminLogin()">Ø¯Ø®ÙˆÙ„</button>
</div>
<!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div class="admin-dashboard" id="adminDashboard">
<div class="admin-header">
<h1>ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Â· Ù†ÙÙ…Ø§Ø¡</h1>
<button class="logout-btn" onclick="adminLogout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</div>
<!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-icon">ğŸ“</div>
<div class="stat-number" id="totalPosts">0</div>
<div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</div>
</div>
<div class="stat-card">
<div class="stat-icon">ğŸ‘¥</div>
<div class="stat-number" id="totalUsers">0</div>
<div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
</div>
<div class="stat-card">
<div class="stat-icon">ğŸ’¬</div>
<div class="stat-number" id="totalComments">0</div>
<div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</div>
</div>
<div class="stat-card">
<div class="stat-icon">ğŸ””</div>
<div class="stat-number" id="totalNotifications">0</div>
<div class="stat-label">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>
</div>
</div>
<!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
<div class="admin-section">
<div class="section-header">
<h2>ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h2>
<button class="refresh-btn" onclick="loadUsers()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
</div>
<div class="table-container">
<table class="admin-table" id="usersTable">
<thead>
<tr>
<th>#</th>
<th>Ø§Ù„Ø§Ø³Ù…</th>
<th>Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„</th>
<th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</th>
<th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
</tr>
</thead>
<tbody id="usersTableBody">
<tr><td colspan="5" class="loading"><div class="loading-spinner"></div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
</tbody>
</table>
</div>
</div>
<!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª -->
<div class="admin-section">
<div class="section-header">
<h2>ğŸ“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</h2>
<div class="btn-group">
<button class="refresh-btn" onclick="loadPosts()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
<button class="delete-all-btn" onclick="showDeleteAllConfirm()">
<span>ğŸ—‘</span>
<span>Ø­Ø°Ù Ø§Ù„ÙƒÙ„</span>
</button>
</div>
</div>
<div class="table-container">
<table class="admin-table" id="postsTable">
<thead>
<tr>
<th>#</th>
<th>ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±</th>
<th>Ø§Ù„Ù…Ø­ØªÙˆÙ‰</th>
<th>Ø§Ù„ØµÙˆØ±</th>
<th>Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª</th>
<th>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</th>
<th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
<th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
</tr>
</thead>
<tbody id="postsTableBody">
<tr><td colspan="8" class="loading"><div class="loading-spinner"></div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- Ù…ÙˆØ¯Ø§Ù„ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù -->
<div class="confirm-modal" id="confirmModal">
<div class="confirm-modal-content">
<div class="confirm-modal-icon">âš ï¸</div>
<h3>ØªØ­Ø°ÙŠØ±: Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</h3>
<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ ØªÙ…Ø§Ù…Ø§Ù‹ Ù…Ù† Ø­Ø°Ù <strong>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</strong>ØŸ<br>Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡ ÙˆØ³ÙŠØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹.</p>
<div class="confirm-modal-buttons">
<button class="confirm-cancel-btn" onclick="hideDeleteAllConfirm()">Ø¥Ù„ØºØ§Ø¡</button>
<button class="confirm-delete-btn" onclick="deleteAllPosts()">Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
</div>
</div>
</div>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
import { getDatabase, ref, onValue, remove, push } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
const firebaseConfig = {
apiKey: "AIzaSyDv348xdxShxrVVAEtIlCpeBfKqvOfY-0o",
authDomain: "talk-19c55.firebaseapp.com",
databaseURL: "https://talk-19c55-default-rtdb.firebaseio.com",
projectId: "talk-19c55",
storageBucket: "talk-19c55.firebasestorage.app",
messagingSenderId: "908101479029",
appId: "1:908101479029:web:8e3fa4ffa469d4e56a663c"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
// Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
const adminLoginView = document.getElementById('adminLoginView');
const adminDashboard = document.getElementById('adminDashboard');
const adminUsername = document.getElementById('adminUsername');
const adminPassword = document.getElementById('adminPassword');
const totalPosts = document.getElementById('totalPosts');
const totalUsers = document.getElementById('totalUsers');
const totalComments = document.getElementById('totalComments');
const totalNotifications = document.getElementById('totalNotifications');
const usersTableBody = document.getElementById('usersTableBody');
const postsTableBody = document.getElementById('postsTableBody');
const confirmModal = document.getElementById('confirmModal');
let allPosts = [];
let allUsers = [];
// ==================== ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† ====================
window.adminLogin = () => {
const username = adminUsername.value.trim();
const password = adminPassword.value.trim();
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ (ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡Ø§)
const ADMIN_USERNAME = 'admin';
const ADMIN_PASSWORD = 'admin123';
if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
localStorage.setItem('namaa_admin', 'true');
showDashboard();
loadAllData();
} else {
alert('âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
}
};
function showDashboard() {
adminLoginView.style.display = 'none';
adminDashboard.style.display = 'block';
}
window.adminLogout = () => {
localStorage.removeItem('namaa_admin');
location.reload();
};
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯Ø®ÙˆÙ„
const isAdminLoggedIn = localStorage.getItem('namaa_admin');
if (isAdminLoggedIn === 'true') {
showDashboard();
loadAllData();
}
// ==================== ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ====================
function loadAllData() {
loadUsers();
loadPosts();
loadStats();
}
// ==================== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ====================
function loadUsers() {
usersTableBody.innerHTML = '<tr><td colspan="5" class="loading"><div class="loading-spinner"></div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
onValue(ref(db, 'posts'), (snapshot) => {
const data = snapshot.val();
allUsers = [];
const userPostsCount = {};
if (data) {
Object.values(data).forEach(post => {
const author = post.author;
const phone = post.authorPhone;
if (!allUsers.find(u => u.name === author)) {
allUsers.push({ name: author, phone: phone, firstPost: post.timestamp });
}
userPostsCount[author] = (userPostsCount[author] || 0) + 1;
});
}
allUsers = allUsers.map(user => ({
...user,
postsCount: userPostsCount[user.name] || 0
}));
allUsers.sort((a, b) => b.firstPost - a.firstPost);
totalUsers.textContent = allUsers.length;
renderUsersTable();
});
}
function renderUsersTable() {
if (allUsers.length === 0) {
usersTableBody.innerHTML = '<tr><td colspan="5" class="no-data">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ† Ø¨Ø¹Ø¯</td></tr>';
return;
}
usersTableBody.innerHTML = allUsers.map((user, index) => `
<tr>
<td>${index + 1}</td>
<td><strong>${user.name}</strong></td>
<td>${user.phone}</td>
<td><span class="badge badge-success">${user.postsCount} Ù…Ù†Ø´ÙˆØ±</span></td>
<td>${new Date(user.firstPost).toLocaleDateString('ar-EG')}</td>
</tr>
`).join('');
}
// ==================== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ====================
function loadPosts() {
postsTableBody.innerHTML = '<tr><td colspan="8" class="loading"><div class="loading-spinner"></div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
onValue(ref(db, 'posts'), (snapshot) => {
const data = snapshot.val();
allPosts = [];
if (data) {
allPosts = Object.entries(data).map(([id, post]) => ({ id, ...post }));
allPosts.sort((a, b) => b.timestamp - a.timestamp);
}
totalPosts.textContent = allPosts.length;
renderPostsTable();
});
}
function renderPostsTable() {
if (allPosts.length === 0) {
postsTableBody.innerHTML = '<tr><td colspan="8" class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¨Ø¹Ø¯</td></tr>';
return;
}
postsTableBody.innerHTML = allPosts.map((post, index) => `
<tr>
<td>${index + 1}</td>
<td><strong>${post.author}</strong></td>
<td>${post.desc ? post.desc.substring(0, 50) + (post.desc.length > 50 ? '...' : '') : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Øµ'}</td>
<td>${post.images && post.images.length > 0 ? `<span class="badge badge-warning">ğŸ“· ${post.images.length}</span>` : '-'}</td>
<td>${post.likes || 0}</td>
<td>${(post.comments || []).length}</td>
<td>${new Date(post.timestamp).toLocaleDateString('ar-EG')}</td>
<td>
<button class="action-btn view-btn" onclick="viewPost('${post.id}')">ğŸ‘ Ø¹Ø±Ø¶</button>
<button class="action-btn delete-btn" onclick="deletePost('${post.id}')">ğŸ—‘ Ø­Ø°Ù</button>
</td>
</tr>
`).join('');
}
// ==================== Ø¹Ø±Ø¶ Ù…Ù†Ø´ÙˆØ± Ù…Ø­Ø¯Ø¯ ====================
window.viewPost = (postId) => {
const post = allPosts.find(p => p.id === postId);
if (!post) return;
let details = `=== ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ± ===\n\n`;
details += `ğŸ‘¤ ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±: ${post.author}\n`;
details += `ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„: ${post.authorPhone}\n`;
details += `ğŸ“ Ø§Ù„Ù…Ø­ØªÙˆÙ‰: ${post.desc || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}\n`;
details += `ğŸ“· Ø§Ù„ØµÙˆØ±: ${post.images ? post.images.length : 0}\n`;
details += `â¤ï¸ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª: ${post.likes || 0}\n`;
details += `ğŸ’¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª: ${(post.comments || []).length}\n`;
details += `ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(post.timestamp).toLocaleString('ar-EG')}\n`;
alert(details);
};
// ==================== Ø­Ø°Ù Ù…Ù†Ø´ÙˆØ± ÙˆØ§Ø­Ø¯ ====================
window.deletePost = (postId) => {
if (confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) {
remove(ref(db, `posts/${postId}`)).then(() => {
alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­');
loadPosts();
loadStats();
}).catch(err => {
alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù: ' + err.message);
});
}
};
// ==================== Ø¥Ø¸Ù‡Ø§Ø± Ù…ÙˆØ¯Ø§Ù„ Ø­Ø°Ù Ø§Ù„ÙƒÙ„ ====================
window.showDeleteAllConfirm = () => {
if (allPosts.length === 0) {
alert('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù„Ø­Ø°ÙÙ‡Ø§');
return;
}
confirmModal.classList.add('show');
};
// ==================== Ø¥Ø®ÙØ§Ø¡ Ù…ÙˆØ¯Ø§Ù„ Ø­Ø°Ù Ø§Ù„ÙƒÙ„ ====================
window.hideDeleteAllConfirm = () => {
confirmModal.classList.remove('show');
};
// ==================== Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ====================
window.deleteAllPosts = () => {
if (allPosts.length === 0) {
hideDeleteAllConfirm();
return;
}
const postsCount = allPosts.length;
hideDeleteAllConfirm();
// Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙˆØ§Ø­Ø¯Ø© ØªÙ„Ùˆ Ø§Ù„Ø£Ø®Ø±Ù‰
let deletedCount = 0;
const deletePromises = allPosts.map(post => {
return remove(ref(db, `posts/${post.id}`))
.then(() => {
deletedCount++;
})
.catch(err => {
console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø´ÙˆØ±:', post.id, err);
});
});
Promise.all(deletePromises).then(() => {
alert(`âœ… ØªÙ… Ø­Ø°Ù ${deletedCount} Ù…Ù† ${postsCount} Ù…Ù†Ø´ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­\n\nØªÙ… ØªÙØ±ÙŠØº ØµÙØ­Ø© Ø§Ù„Ø¥Ù†Ø¯ÙŠÙƒØ³ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª!`);
loadPosts();
loadUsers();
loadStats();
}).catch(err => {
alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù: ' + err.message);
});
};
// ==================== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ====================
function loadStats() {
let commentsCount = 0;
allPosts.forEach(post => {
commentsCount += (post.comments || []).length;
});
totalComments.textContent = commentsCount;
onValue(ref(db, 'notifications'), (snapshot) => {
const data = snapshot.val();
const notificationsCount = data ? Object.keys(data).length : 0;
totalNotifications.textContent = notificationsCount;
});
}
// ==================== Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØµÙØ­Ø© ====================
adminPassword.addEventListener('keypress', e => {
if (e.key === 'Enter') {
adminLogin();
}
});
// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
confirmModal.addEventListener('click', (e) => {
if (e.target === confirmModal) {
hideDeleteAllConfirm();
}
});
</script>
</body>
</html>

